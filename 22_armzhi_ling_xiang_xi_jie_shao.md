# 2.2 ARM指令详细介绍

## 2.2.1 指令的寻址方式

### 立即寻址

立即寻址也叫立即数寻址，这是一种特殊的寻址方式，操作数本身就在指令中给出，只要取出指令也就取到了操作数。这个操作数被称为立即数，对应的寻址方式也就叫做立即寻址。例如以下指令：

ADD    R0，R0，＃1            ；R0←R0＋1

ADD    R0，R0，＃0x3f            ；R0←R0＋0x3f

在以上两条指令中，第二个源操作数即为立即数，要求以“＃”为前缀，对于以十六进制表示的立即数，还要求在“＃”后加上“0x”或“&”。

### 寄存器寻址

寄存器寻址就是利用寄存器中的数值作为操作数，这种寻址方式是各类微处理器经常采用的一种方式，也是一种执行效率较高的寻址方式。以下指令：

ADD    R0，R1，R2            ；R0←R1＋R2

该指令的执行效果是将寄存器R1和R2的内容相加，其结果存放在寄存器R0中。

### 基址变址寻址

基址变址寻址就是将寄存器（该寄存器一般称作基址寄存器）的内容与指令中给出的地址偏移量相加，从而得到一个操作数的有效地址。变址寻址方式常用于访问某基地址附近的地址单元。采用变址寻址方式的指令常见有以下几种形式，如下所示：

LDR R0，\[R1，＃4\] ；R0←\[R1＋4\]

LDR R0，\[R1，＃4\]！ ；R0←\[R1＋4\]、R1←R1＋4

LDR R0，\[R1\] ，＃4 ；R0←\[R1\]、R1←R1＋4

LDR R0，\[R1，R2\] ；R0←\[R1＋R2\]

### 多寄存器寻址

采用多寄存器寻址方式，一条指令可以完成多个寄存器值的传送。这种寻址方式可以用一条指令完成传送最多16个通用寄存器的值。以下指令：

LDMIA R0，{R1，R2，R3，R4} ；R1←\[R0\] ；R2←\[R0＋4\] ；R3←\[R0＋8\] ；R4←\[R0＋12\]

该指令的后缀IA表示在每次执行完加载\/存储操作后，R0按字长度增加，因此，指令可将连续存储单元的值传送到R1～R4。

### 相对寻址

与基址变址寻址方式相类似，相对寻址以程序计数器PC的当前值为基地址，指令中的地址标号作为偏移量，将两者相加之后得到操作数的有效地址。以下程序段完成子程序的调用和返回，跳转指令BL采用了相对寻址方式：

BL NEXT ；跳转到子程序NEXT处执行

……

NEXT

……

MOV PC，LR ；从子程序返回

### 堆栈寻址

堆栈是一种数据结构，按先进后出（First In Last Out，FILO）的方式工作，使用一个称作堆栈指针的专用寄存器指示当前的操作位置，堆栈指针总是指向栈顶。

当堆栈指针指向最后压入堆栈的数据时，称为满堆栈（Full Stack），而当堆栈指针指向下一个将要放入数据的空位置时，称为空堆栈\(Empty Stack\)。

## 2.2.2 ARM指令集

### 跳转指令

B 跳转指令

BL 带返回的跳转指令

BLX 带返回和状态切换的跳转指令

BX 带状态切换的跳转指令

### 数据处理指令

MOV 数据传送指令 MVN 数据取反传送指令

CMP 比较指令 CMN 反值比较指令

TST 位测试指令 TEQ 相等测试指令

ADD 加法指令 ADC 带进位加法指令

SUB 减法指令 SBC 带借位减法指令

RSB 逆向减法指令 RSC 带借位的逆向减法指令

AND 逻辑与指令 ORR 逻辑或指令

EOR 逻辑异或指令 BIC 位清除指令

### 乘法指令与乘加指令

MUL 32位乘法指令

MLA 32位乘加指令

SMULL 64位有符号数乘法指令

SMLAL 64位有符号数乘加指令

UMULL 64位无符号数乘法指令

UMLAL 64位无符号数乘加指令

### 程序状态寄存器访问指令

MRS 程序状态寄存器到通用寄存器的数据传送指令

MSR 通用寄存器到程序状态寄存器的数据传送指令

### 加载\/存储指令

LDR 字数据加载指令

LDRB 字节数据加载指令

LDRH 半字数据加载指令

STR 字数据存储指令

STRB 字节数据存储指令

STRH 半字数据存储指令

### 批量数据加载\/存储指令

LDM 批量数据加载指令

STM 批量数据存储指令

### 批量数据加载\/存储指令

LDM 批量数据加载指令

STM 批量数据存储指令

### 移位指令（操作）

LSL 逻辑左移

ASL 算术左移

LSR 逻辑右移

ASR 算术右移

ROR 循环右移

RRX 带扩展的循环右移

### 协处理器指令

CDP 协处理器数操作指令

LDC 协处理器数据加载指令

STC 协处理器数据存储指令

MCR ARM处理器寄存器到协处理器寄存器的数据传送指令

MRC 协处理器寄存器到ARM处理器寄存器的数据传送指令

### 异常产生指令

 SWI 软件中断指令

 BKPT 断点中断指令

